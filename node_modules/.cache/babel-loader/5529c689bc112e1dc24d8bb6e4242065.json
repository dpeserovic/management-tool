{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = undefined;\n\nvar _get2 = require('lodash/get');\n\nvar _get3 = _interopRequireDefault(_get2);\n\nvar _isString2 = require('lodash/isString');\n\nvar _isString3 = _interopRequireDefault(_isString2);\n\nvar _pick2 = require('lodash/pick');\n\nvar _pick3 = _interopRequireDefault(_pick2);\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _mobx = require('mobx');\n\nvar _Options = require('./Options');\n\nvar _Options2 = _interopRequireDefault(_Options);\n\nvar _Bindings = require('./Bindings');\n\nvar _Bindings2 = _interopRequireDefault(_Bindings);\n\nvar _utils = require('./utils');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar State = function () {\n  function State(_ref) {\n    var form = _ref.form,\n        initial = _ref.initial,\n        options = _ref.options,\n        bindings = _ref.bindings;\n\n    _classCallCheck(this, State);\n\n    this.mode = 'mixed';\n    this.strict = false;\n    this.disposers = {\n      interceptor: {},\n      observer: {}\n    };\n    this.$struct = [];\n    this.initial = {\n      props: {},\n      fields: {}\n    };\n    this.current = {\n      props: {},\n      fields: {}\n    };\n    this.set('form', form);\n    this.initProps(initial);\n    this.options = new _Options2.default();\n    this.options.set(options);\n    this.bindings = new _Bindings2.default();\n    this.bindings.register(bindings);\n    this.observeOptions();\n  }\n\n  _createClass(State, [{\n    key: 'initProps',\n    value: function initProps(initial) {\n      var initialProps = (0, _pick3.default)(initial, [].concat(_toConsumableArray(_utils2.default.props.separated), _toConsumableArray(_utils2.default.props.validation), _toConsumableArray(_utils2.default.props.function), _toConsumableArray(_utils2.default.props.handlers)));\n      this.set('initial', 'props', initialProps);\n\n      var $unified = _utils2.default.hasUnifiedProps(initial);\n\n      var $separated = _utils2.default.hasSeparatedProps(initial);\n\n      if ($unified && $separated) {\n        console.warn( // eslint-disable-line\n        'WARNING: Your mobx-react-form instance ', this.form.name, ' is running in MIXED Mode (Unified + Separated) as fields properties definition.', 'This mode is experimental, use it at your own risk, or use only one mode.');\n      }\n\n      if (($separated || _utils2.default.isStruct(initial.fields)) && !$unified) {\n        var struct = _utils2.default.$try(initial.struct || initial.fields);\n\n        this.struct(struct);\n        this.strict = true;\n        this.mode = 'separated';\n        return;\n      }\n\n      this.struct(initial.struct);\n      this.mode = 'unified';\n    }\n    /**\n      Get/Set Fields Structure\n    */\n\n  }, {\n    key: 'struct',\n    value: function struct() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      if (data) this.$struct = data;\n      return this.$struct;\n    }\n    /**\n      Get Props/Fields\n    */\n\n  }, {\n    key: 'get',\n    value: function get(type, subtype) {\n      return this[type][subtype];\n    }\n    /**\n      Set Props/Fields\n    */\n\n  }, {\n    key: 'set',\n    value: function set(type, subtype) {\n      var state = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      if (type === 'form') {\n        // subtype is the form here\n        this.form = subtype;\n      }\n\n      if (type === 'initial') {\n        Object.assign(this.initial[subtype], state);\n        Object.assign(this.current[subtype], state);\n      }\n\n      if (type === 'current') {\n        Object.assign(this.current[subtype], state);\n      }\n    }\n  }, {\n    key: 'extra',\n    value: function extra() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      if ((0, _isString3.default)(data)) return (0, _get3.default)(this.$extra, data);\n      if (data === null) return this.$extra;\n      this.$extra = data;\n      return null;\n    }\n  }, {\n    key: 'observeOptions',\n    value: function observeOptions() {\n      var _this = this; // Fix Issue #201\n\n\n      (0, _mobx.observe)(this.options.options, _utils2.default.checkObserve([{\n        // start observing fields validateOnChange\n        type: 'update',\n        key: 'validateOnChange',\n        to: true,\n        exec: function exec() {\n          return _this.form.each(function (field) {\n            return field.observeValidationOnChange();\n          });\n        }\n      }, {\n        // stop observing fields validateOnChange\n        type: 'update',\n        key: 'validateOnChange',\n        to: false,\n        exec: function exec() {\n          return _this.form.each(function (field) {\n            return field.disposeValidationOnChange();\n          });\n        }\n      }, {\n        // start observing fields validateOnBlur\n        type: 'update',\n        key: 'validateOnBlur',\n        to: true,\n        exec: function exec() {\n          return _this.form.each(function (field) {\n            return field.observeValidationOnBlur();\n          });\n        }\n      }, {\n        // stop observing fields validateOnBlur\n        type: 'update',\n        key: 'validateOnBlur',\n        to: false,\n        exec: function exec() {\n          return _this.form.each(function (field) {\n            return field.disposeValidationOnBlur();\n          });\n        }\n      }]));\n    }\n  }]);\n\n  return State;\n}();\n\nexports.default = State;\nmodule.exports = exports['default'];","map":{"version":3,"sources":["D:/management-tool/node_modules/mobx-react-form/lib/State.js"],"names":["Object","defineProperty","exports","value","default","undefined","_get2","require","_get3","_interopRequireDefault","_isString2","_isString3","_pick2","_pick3","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_mobx","_Options","_Options2","_Bindings","_Bindings2","_utils","_utils2","obj","__esModule","_toConsumableArray","arr","Array","isArray","arr2","from","_classCallCheck","instance","TypeError","State","_ref","form","initial","options","bindings","mode","strict","disposers","interceptor","observer","$struct","fields","current","set","initProps","register","observeOptions","initialProps","concat","separated","validation","function","handlers","$unified","hasUnifiedProps","$separated","hasSeparatedProps","console","warn","name","isStruct","struct","$try","data","arguments","get","type","subtype","state","assign","extra","$extra","_this","observe","checkObserve","to","exec","each","field","observeValidationOnChange","disposeValidationOnChange","observeValidationOnBlur","disposeValidationOnBlur","module"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = undefined;\n\nvar _get2 = require('lodash/get');\n\nvar _get3 = _interopRequireDefault(_get2);\n\nvar _isString2 = require('lodash/isString');\n\nvar _isString3 = _interopRequireDefault(_isString2);\n\nvar _pick2 = require('lodash/pick');\n\nvar _pick3 = _interopRequireDefault(_pick2);\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _mobx = require('mobx');\n\nvar _Options = require('./Options');\n\nvar _Options2 = _interopRequireDefault(_Options);\n\nvar _Bindings = require('./Bindings');\n\nvar _Bindings2 = _interopRequireDefault(_Bindings);\n\nvar _utils = require('./utils');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar State = function () {\n  function State(_ref) {\n    var form = _ref.form,\n        initial = _ref.initial,\n        options = _ref.options,\n        bindings = _ref.bindings;\n\n    _classCallCheck(this, State);\n\n    this.mode = 'mixed';\n    this.strict = false;\n    this.disposers = {\n      interceptor: {},\n      observer: {}\n    };\n    this.$struct = [];\n    this.initial = {\n      props: {},\n      fields: {}\n    };\n    this.current = {\n      props: {},\n      fields: {}\n    };\n\n    this.set('form', form);\n    this.initProps(initial);\n    this.options = new _Options2.default();\n    this.options.set(options);\n    this.bindings = new _Bindings2.default();\n    this.bindings.register(bindings);\n    this.observeOptions();\n  }\n\n  _createClass(State, [{\n    key: 'initProps',\n    value: function initProps(initial) {\n      var initialProps = (0, _pick3.default)(initial, [].concat(_toConsumableArray(_utils2.default.props.separated), _toConsumableArray(_utils2.default.props.validation), _toConsumableArray(_utils2.default.props.function), _toConsumableArray(_utils2.default.props.handlers)));\n\n      this.set('initial', 'props', initialProps);\n\n      var $unified = _utils2.default.hasUnifiedProps(initial);\n      var $separated = _utils2.default.hasSeparatedProps(initial);\n\n      if ($unified && $separated) {\n        console.warn( // eslint-disable-line\n        'WARNING: Your mobx-react-form instance ', this.form.name, ' is running in MIXED Mode (Unified + Separated) as fields properties definition.', 'This mode is experimental, use it at your own risk, or use only one mode.');\n      }\n\n      if (($separated || _utils2.default.isStruct(initial.fields)) && !$unified) {\n        var struct = _utils2.default.$try(initial.struct || initial.fields);\n        this.struct(struct);\n        this.strict = true;\n        this.mode = 'separated';\n        return;\n      }\n\n      this.struct(initial.struct);\n      this.mode = 'unified';\n    }\n\n    /**\n      Get/Set Fields Structure\n    */\n\n  }, {\n    key: 'struct',\n    value: function struct() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n      if (data) this.$struct = data;\n      return this.$struct;\n    }\n\n    /**\n      Get Props/Fields\n    */\n\n  }, {\n    key: 'get',\n    value: function get(type, subtype) {\n      return this[type][subtype];\n    }\n\n    /**\n      Set Props/Fields\n    */\n\n  }, {\n    key: 'set',\n    value: function set(type, subtype) {\n      var state = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      if (type === 'form') {\n        // subtype is the form here\n        this.form = subtype;\n      }\n\n      if (type === 'initial') {\n        Object.assign(this.initial[subtype], state);\n        Object.assign(this.current[subtype], state);\n      }\n\n      if (type === 'current') {\n        Object.assign(this.current[subtype], state);\n      }\n    }\n  }, {\n    key: 'extra',\n    value: function extra() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n      if ((0, _isString3.default)(data)) return (0, _get3.default)(this.$extra, data);\n      if (data === null) return this.$extra;\n      this.$extra = data;\n      return null;\n    }\n  }, {\n    key: 'observeOptions',\n    value: function observeOptions() {\n      var _this = this;\n\n      // Fix Issue #201\n      (0, _mobx.observe)(this.options.options, _utils2.default.checkObserve([{\n        // start observing fields validateOnChange\n        type: 'update',\n        key: 'validateOnChange',\n        to: true,\n        exec: function exec() {\n          return _this.form.each(function (field) {\n            return field.observeValidationOnChange();\n          });\n        }\n      }, {\n        // stop observing fields validateOnChange\n        type: 'update',\n        key: 'validateOnChange',\n        to: false,\n        exec: function exec() {\n          return _this.form.each(function (field) {\n            return field.disposeValidationOnChange();\n          });\n        }\n      }, {\n        // start observing fields validateOnBlur\n        type: 'update',\n        key: 'validateOnBlur',\n        to: true,\n        exec: function exec() {\n          return _this.form.each(function (field) {\n            return field.observeValidationOnBlur();\n          });\n        }\n      }, {\n        // stop observing fields validateOnBlur\n        type: 'update',\n        key: 'validateOnBlur',\n        to: false,\n        exec: function exec() {\n          return _this.form.each(function (field) {\n            return field.disposeValidationOnBlur();\n          });\n        }\n      }]));\n    }\n  }]);\n\n  return State;\n}();\n\nexports.default = State;\nmodule.exports = exports['default'];"]},"metadata":{},"sourceType":"script"}